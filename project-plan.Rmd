---
title: "Rough Plan"
author: "Rose Campos, Jessenia Contreras"
date: "2024-04-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Introduction

Have you ever seen a film, and thought to yourself "Oh my god! This movie is a masterpiece!" Only to look it up and see a 2.4 IMB rating?
Through this report, we take a data set of fifty beloved 'popular' films containing a quantitative measure of level of enjoyment, appreciation, and deemed classical-ness to create a comprehensive analysis that takes into account the film's genre and the demographic of viewers. 
The data we used was gathered from a sample pool of 282 participants of which only 69 where male. The participant pool had an age range of 19 to 37 with the median age range being 22.25. The ethnicity distribution was 39% was Caucasian, 31.5% was Asian, ~13.5% was Hispanic, ~2% was African American, and ~12% Unknown. The remaining percentage is filled by Pacific Islanders and other ethnicity. This data was collected by attendees of the University of Texas at Austin in 2017 for a Journal of Media Psychology publication. The goal of the original source was to determine how enjoyment and appreciation could impact viewers aggregate appraisals. The data used is available for download and review at [Data.World](https://data.world/robertjoellewis/enjoyment-versus-appreciation-ratings-of-50-popular-films).

## Data Preparation

Below, we load in the packages we'll be using to analyse our data.  

```{r}
#Packages loading to use
library(tidyverse) ##Loaded for dplyr and to 'clean' data
library(ggplot2) ##Loaded for plotting
library(dplyr) ##Loaded for computer issues

```

Now, we'll read in the data from its .CSV file into our project and save it to the variable **raw_data**. 

```{r}
##Read in data and save it to variable raw_data
raw_data <- read.csv(file = "popular_film_data.csv")
glimpse (raw_data)
```
Some of the data contained in the the variables *InflatedBudget*, *InflatedGross*, and *TotalGross* have symbols such as "$" and and ",". These symbols cause the the information in them to be read as characters rather then as integers. We use gsub to remove these symbols. 
```{r}
#To remove "$" and "," from InflatedBudget
raw_data$InflatedBudget <-  gsub("\\$","", raw_data$InflatedBudget) 
raw_data$InflatedBudget <-  as.numeric(gsub(",","", raw_data$InflatedBudget))

#To remove "$" and "," from InflatedGross
raw_data$InflatedGross <-  gsub("\\$","", raw_data$InflatedGross) 
raw_data$InflatedGross <-  as.numeric(gsub(",","", raw_data$InflatedGross))

#To remove "$" and "," from TotalGross
raw_data$TotalGross <-  gsub("\\$","", raw_data$TotalGross) 
raw_data$TotalGross <-  as.numeric(gsub(",","", raw_data$TotalGross))

#To View our now changed data. 
glimpse (raw_data)
```
Now, we also see that our data has a *Proportion_male* column. Lets mutate that so we can also see the female ratio and store it in the variable *Proportion_female*.
```{r}
raw_data <- raw_data |> mutate (Proportion_female = (1 - Proportion_male))

#To view our data with the new variable.
glimpse(raw_data)
```
## Data Analysis INSTRUCTIONS

- Uncover new information in the data that isn’t immediately apparent (such as: don’t just plot the data as is, but filter or group the data in
different ways, create new variables, or join different data frames together to get new summaries)
- Provide your findings in plots or tables. Display findings in different ways.
- Graphs all have purpose and help tell your story. Make sure you have a graph that illustrates your primary point and that they are all
appropriately formatted (plot and axis titles, legends if needed, appropriate plot types used)
- Use tables effectively to perform comparisons, highlighting important features.
- Your analysis should be thoroughly, yet concisely, explained. Make sure your insights and discoveries are highlighted, and easy to see and
understand

We'll start by learning about our data has. What is the year range of it? How many films make up our data? How many films of each genere are there? 
```{r}
#What is the release year range of the films in our dataset?
range(raw_data$Year)

```
Does the data contain multiple films per year? Is so, what is the count for each year? 
```{r}
 raw_data|>group_by(Year) |> summarise(Movie_Count = n()) |> arrange(desc(Movie_Count))

```
The above is arranged by to be descending by amount of movies present of each year but it is difficult to see this overall. To give visibility to this distribution we create a plot based on the above coding. First we save it to a variable. 

```{r}
#Storing the code to the "count_movieby_year" variable. 

count_movieby_year <-  raw_data|>group_by(Year) |> summarise(Movie_Count = n()) |> arrange(desc(Movie_Count))
ggplot(count_movieby_year, aes(x = Year, y = Movie_Count)) + geom_col()
```
Notice the distribution of the films in the data. Out of 50 films, only 11 are pre-1990's while the remaining majority are from the early 1990's to the late 2010's. Keep in mind that this uneven distribution of films might impact the conclusions drawn from the data. 

Next, we wanted to find the average budget for each year. We want to see if the year had an impact on the budget. 
```{r}
raw_data |> group_by(Year)|> summarise(InflatedBudget) |> ggplot(aes(Year,InflatedBudget)) +geom_point() + geom_smooth()
```

From the graph we can see there is a trend. The graphs tell us that the closer we get to right side of the graph(closer to the year 2013), the budget have increase. There is a rapid increase from the year 1990's to the year 2010's.

Now we want to see, if what the relation is between a films budget and gross income. First we focus on the plotting the *InflatedGross* income. 
```{r}
raw_data |> group_by(Year) |> summarise(InflatedGross) |> ggplot(aes(Year,InflatedGross)) +geom_point() + geom_smooth()

```

It's a little hard to compare the *InflatedGross* income and the *InflatedBudget* in two graphs so lets display this information together so we can analyse it. 

```{r}
#raw_data |> group_by(Year)|> ggplot(aes(Year,InflatedGross, InflatedBudget, color = )) +geom_point() + geom_smooth(method = 'loess', formula = 'y~x')

raw_data |> group_by(Year) |> ggplot(aes(x=Year))+geom_point(aes(y=InflatedBudget),color = "red") + geom_point(aes(y=InflatedGross), color = "blue") + geom_smooth(aes(y=InflatedBudget), color = "red") + geom_smooth(aes(y=InflatedGross), color = "blue")


```

Given that the y-axis is going by much larger facter than what the *InflatedBudget is going by 

we can tell from this graph that companies put a lot of money in to production of the movie but they don"t make that money back. 
Now let get a closer look on which years actually made the most money. This data will be use later to compare which movie is the best. 

```{r}
raw_data |> slice_max(InflatedGross, n = 10) |> select(FilmName, Year, InflatedGross)
```


BLAH BLAH, GO OVER RELATIONSHIP WITH GRAPH. 

###Genres

Is there a specific genre that costs more to produce? First, we'll see what the most and least expensive films to produce where.

```{r}
raw_data |> slice_max(InflatedBudget, n = 1) |> select(FilmName, InflatedGross)
raw_data |> slice_min(InflatedBudget, n = 1) |> select(FilmName, InflatedGross)

```


And what films made the most and least grossing? What genres where these films?

```{r}
raw_data |> slice_max(InflatedGross, n = 10) |> select(FilmName, InflatedGross)
#still need the genre
```
We know the answers to these questions for indivudual film entries - now we'll answer them for the genre category. 

```{r}
#We'll arrange the code to output what we need to see. 
genreGrossBudget <- (rbind(cbind(genre = "Comedy", raw_data %>% filter(Comedy == 1) %>% summarise(meangross = mean(InflatedGross), meanBudget = mean(InflatedBudget))),
      cbind(genre = "Drama", raw_data %>% filter(Drama == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
      cbind(genre = "Western", raw_data %>% filter(Western == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
      cbind(genre = "Action", raw_data %>% filter(Action == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
     cbind(genre = "Biography", raw_data %>% filter(Biography == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "History", raw_data %>% filter(History == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))), 
    cbind(genre = "Adventure", raw_data %>% filter(Adventure == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
        cbind(genre = "Fantasy", raw_data %>% filter(Fantasy == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Mystery", raw_data %>% filter(Mystery == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "SciFi", raw_data %>% filter(SciFi == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Romance", raw_data %>% filter(Romance == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Thriller", raw_data %>% filter(Drama == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Crime", raw_data %>% filter(Crime == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "War", raw_data %>% filter(War == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Family", raw_data %>% filter(Family == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget))),
    cbind(genre = "Animation", raw_data %>% filter(Animation == 1) %>% summarise(meangross = mean(InflatedGross),meanBudget = mean(InflatedBudget)))) %>% arrange(desc(meanBudget)))
```

```{r}
#Over all, what genre cost more to produce on average? How much did that category produce in grossing? 
genreGrossBudget |> slice(which(meanBudget ==max(meanBudget) | meanBudget == min(meanBudget))) |> distinct()
#Over all, what genre cost more to produce on average? How much did that category produce in grossings?

```
For transparencys sake, its also important to note how many films under each genre make up the dataset.    

```{r}

rbind(cbind(genre = "Comedy", raw_data %>% filter(Comedy == 1) %>% summarise(sum = sum(Comedy == 1))),
    cbind(genre = "Drama", raw_data %>% filter(Drama == 1) %>% summarise(sum = sum(Drama == 1))),
    cbind(genre = "Western", raw_data %>% filter(Western == 1) %>% summarise(sum = sum(Western == 1))),
    cbind(genre = "Action", raw_data %>% filter(Action == 1) %>% summarise(sum = sum(Action == 1))),
    cbind(genre = "Biography", raw_data %>% filter(Biography == 1) %>% summarise(sum = sum(Biography == 1))),
    cbind(genre = "History", raw_data %>% filter(History == 1) %>% summarise(sum = sum(History == 1))),
    cbind(genre = "Adventure", raw_data %>% filter(Adventure == 1) %>% summarise(sum = sum(Adventure == 1))),
    cbind(genre = "Fantasy", raw_data %>% filter(Fantasy == 1) %>% summarise(sum = sum(Fantasy == 1))),
    cbind(genre = "Mystery", raw_data %>% filter(Mystery == 1) %>% summarise(sum = sum(Mystery == 1))),
    cbind(genre = "SciFi", raw_data %>% filter(SciFi == 1) %>% summarise(sum = sum(SciFi == 1))),
    cbind(genre = "Romance", raw_data %>% filter(Romance == 1) %>% summarise(sum = sum(Romance == 1))),
    cbind(genre = "Thriller", raw_data %>% filter(Thriller == 1) %>% summarise(sum = sum(Thriller == 1))),
    cbind(genre = "Crime", raw_data %>% filter(Crime == 1) %>% summarise(sum = sum(Crime == 1))),
    cbind(genre = "War", raw_data %>% filter(War == 1) %>% summarise(sum = sum(War == 1))),
    cbind(genre = "Family", raw_data %>% filter(Family == 1) %>% summarise(sum = sum(Family == 1))),
    cbind(genre = "Animation", raw_data %>% filter(Animation == 1) %>% summarise(sum = sum(Animation == 1))))%>% arrange(desc(sum))

#the end of numbers of genre

```
###T
```{r}
#popularity

```
Let see what movie is actually the best. 
```{r}
raw_data |> slice_max(Appreciation, n = 10)|> select(FilmName,Appreciation, Enjoyment)

raw_data |> slice_max(Enjoyment, n = 10) |> select(FilmName, Enjoyment, Appreciation)

raw_data |> slice_max(InflatedGross, n = 10) |> select(FilmName, InflatedGross, Appreciation, Enjoyment)
```


## Questions

- Which movies were top rated in appreciation / enjoyment?

- Which genre have the highest appreciation rating? 
- Which genre have the highest enjoyment rating? 
which genre cost more to produce?
which genre has the highest income? Which sex contributes more to that income. Mutate each film to multiply ratio by income. Then Summarize by genre = true. Repeat for male so you can see both contributions. 
**We still have the classical-ness and popularity to mess around with. 

- Gender and how it affects budget. (Which gender contributes more to the gross of each genre- after budge/gross | pink blue)
apreciation per genre
enjoyment and genre


```
